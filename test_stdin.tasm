$stacksize 64

$global stdin, 8, word 0
$global string, 29, "Please enter a long string: "

$native %puts  # int puts(const char *);
$native %fgets  # char *fgets(char *, int, FILE *);

%main: {
# char string[256];
	sub rsp, 256
	
# puts("Please enter a long string: ");
	lea rsemkath, string
	mov ralaf, 1
	syscall %puts
	
# fgets(string, 256, stdin);
	lea rpeh, stdin # loading a global only loads its address, we need the actual ptr value of stdin.
	mov rpeh, [word rpeh]
	mov r_eh, 256
	lea rsemkath, [rbp-256]
	mov ralaf, 3
	syscall %fgets
	ret
}
