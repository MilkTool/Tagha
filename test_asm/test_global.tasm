####################################################
# struct Player {
#     float32_t   speed;
#     uint32_t    health, ammo;
# } g_player;
# 
# g_player is defined in this script
# but its data will be supplied from the host!
####################################################

$stacksize 8    # 64 byte stack is more than enough really.
$global g_player, 12,    0

%main: {
    movi        r1, 32
    sub         rsp, r1
    ldvar       r1, g_player
    
    movi        r2, 0x43960000   ; 300.f as a 32-bit int hex
    st4         [r1], r2         ; g_player.speed = 300.f;
    
    movi        r2, 100
    st4         [r1+4], r2       ; g_player.health = 100;
    
    movi        r2, 32
    st4         [r1+8], r2       ; g_player.ammo = 32;
    
    ret
}
