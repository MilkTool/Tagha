####################################################
# struct Player {
#     float32_t   speed;
#     uint32_t    health, ammo;
# } g_player;
# 
# g_player is defined in this script
# but its data will be supplied from the host!
####################################################

$stacksize 8    # 64 byte stack is more than enough really.
$global g_player, 12,    0

%main: {
    movi        rgamal, 32
    sub         rsp, rgamal
    loadglobal  rgamal, g_player
    
    movi        rdalath, 0x43960000   ; 300.f as a 32-bit int hex
    st4         [rgamal], rdalath     ; g_player.speed = 300.f;
    
    movi        rdalath, 100
    st4         [rgamal+4], rdalath   ; g_player.health = 100;
    
    movi        rdalath, 32
    st4         [rgamal+8], rdalath   ; g_player.ammo = 32;
    
    ret
}
